<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¡—ç¥æ°´é›»ç‹å­ 21é»æŒ‘æˆ°è³½ (è‡ªè¨‚åœ–ç‰‡ç‰ˆ)</title>
    <style>
        /* æ•´é«”èƒŒæ™¯ï¼šæ·±è‰²å·¥æ¥­é¢¨ */
        body {
            font-family: 'Microsoft JhengHei', 'Helvetica Neue', Arial, sans-serif;
            background-color: #1a1a1a; 
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: white;
            background-image: radial-gradient(#333 15%, transparent 16%), radial-gradient(#333 15%, transparent 16%);
            background-size: 20px 20px;
        }

        /* ç‰Œæ¡Œè¨­è¨ˆ */
        .game-table {
            background-color: #4a4a4a; /* æ°´æ³¥ç° */
            border: 15px solid #e67e22; /* å¡—ç¥æ©˜ */
            border-radius: 20px;
            padding: 30px; 
            width: 800px;
            box-shadow: 0 10px 40px rgba(230, 126, 34, 0.3); /* æ©˜è‰²å…‰æšˆ */
            text-align: center;
            position: relative;
        }

        /* æ¨™é¡Œç‰¹æ•ˆ */
        h1 { 
            margin-top: 0; 
            color: #f39c12;
            text-shadow: 2px 2px 0px #000;
            font-size: 32px;
            letter-spacing: 2px;
            margin-bottom: 15px;
        }
        
        .hand-area {
            margin: 15px 0;
            min-height: 160px;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            padding: 10px;
            border: 1px solid #666;
        }
        
        .cards-container {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 10px;
        }

        /* å¡ç‰Œæ¨£å¼ */
        .card {
            width: 80px;
            height: 120px;
            background: white;
            border-radius: 8px;
            color: black;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 5px;
            box-shadow: 3px 3px 8px rgba(0,0,0,0.4);
            font-weight: bold;
            font-size: 20px;
            position: relative;
            transition: transform 0.2s;
        }
        
        .card:hover { transform: translateY(-5px); }
        .card.red { color: #c0392b; }
        .card.black { color: #2c3e50; }

        .suit-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 40px;
        }

        /* åˆ†æ•¸é¡¯ç¤ºæ¿ */
        .score-display {
            font-size: 18px;
            background: #e67e22; /* æ©˜åº• */
            color: white;
            display: inline-block;
            padding: 5px 15px;
            border-radius: 50px;
            margin-bottom: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            font-weight: bold;
        }

        .controls { margin-top: 20px; }

        button {
            padding: 12px 30px;
            font-size: 18px;
            margin: 0 10px;
            cursor: pointer;
            border: none;
            border-radius: 8px;
            transition: all 0.1s;
            font-weight: bold;
            box-shadow: 0 4px 0 rgba(0,0,0,0.2);
        }
        
        button:active { transform: translateY(4px); box-shadow: none; }
        
        /* æŒ‰éˆ•é…è‰² */
        #btn-hit { background-color: #f39c12; color: #2c3e50; } 
        #btn-stand { background-color: #c0392b; color: white; } 
        #btn-new { background-color: #3498db; color: white; display: none; } 

        #message-area {
            height: 30px;
            font-size: 24px;
            font-weight: bold;
            margin-top: 15px;
            color: #f1c40f;
            text-shadow: 1px 1px 4px black;
        }

        /* å¡—ç¥åœ–ç‰‡å€åŸŸ */
        #tushen-image-container {
            margin-bottom: 15px;
            height: 220px; 
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        #tushen-image {
            max-height: 100%;
            max-width: 100%;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            transition: all 0.5s ease; 
            border: 3px solid transparent;
        }

        .tushen-label {
            position: absolute;
            bottom: -10px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 5px 20px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 20px;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            white-space: nowrap;
        }

        .icon { font-size: 24px; vertical-align: middle; margin-right: 5px; }
    </style>
</head>
<body>

<div class="game-table">
    <h1>ğŸ› ï¸ å¡—ç¥æ°´é›»ç‹å­ 21é»å¤§è³½ ğŸš°</h1>

    <div id="tushen-image-container">
        <img id="tushen-image" src="TUSHENDRAW.png" alt="å¡—ç¥æ°´é›»ç‹å­">
        <div id="tushen-label" class="tushen-label"></div>
    </div>

    <div class="hand-area" style="background: rgba(230, 126, 34, 0.1);">
        <div class="score-display">
            <span class="icon">ğŸ‘·</span>å¡—ç¥æ°´é›»ç‹å­: <span id="dealer-score">0</span>
        </div>
        <div class="cards-container" id="dealer-cards"></div>
    </div>

    <div class="hand-area">
        <div class="score-display">
            <span class="icon">ğŸ‘¤</span>æ‚¨çš„é»æ•¸: <span id="player-score">0</span>
        </div>
        <div class="cards-container" id="player-cards"></div>
    </div>

    <div id="message-area">æº–å‚™å¥½æŒ‘æˆ°å¡—ç¥äº†å—ï¼ŸæŒ‰ç™¼ç‰Œé–‹å§‹ï¼</div>

    <div class="controls">
        <button id="btn-new" onclick="startGame()" style="display:inline-block;">ç™¼ç‰Œ</button>
        <button id="btn-hit" onclick="hit()" style="display:none;">è¦ç‰Œ (Hit)</button>
        <button id="btn-stand" onclick="stand()" style="display:none;">åœç‰Œ (Stand)</button>
    </div>
</div>

<script>
    // éŠæˆ²è®Šæ•¸
    const suits = ['â™ ', 'â™¥', 'â™¦', 'â™£'];
    const values = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
    let deck = [];
    let playerHand = [];
    let dealerHand = [];
    let gameOver = false;

    // åœ–ç‰‡è³‡æ–™åº« (å·²ä¿®æ”¹ç‚ºæ‚¨æŒ‡å®šçš„æª”å)
    const tushenImages = {
        // normal: éŠæˆ²å‰›é–‹å§‹çš„ç‹€æ…‹ï¼Œé€™è£¡æš«æ™‚è¨­å®šç‚ºå¹³æ‰‹åœ–ï¼Œæ‚¨ä¹Ÿå¯ä»¥æ”¾ä¸€å¼µå°ˆé–€çš„é–‹å ´åœ–
        normal: { src: "TUSHENDRAW.png", label: "", border: "transparent" }, 
        // win: å¡—ç¥è´ (å°æ‡‰ TUSHENWIN.png)
        win: { src: "TUSHENWIN.png", label: "å¡—ç¥ï¼šå“ˆå“ˆï¼æˆ‘è´å•¦ï¼ğŸ˜", border: "#e74c3c" }, 
        // lose: å¡—ç¥è¼¸ (å°æ‡‰ TUSHENLOSE.png)
        lose: { src: "TUSHENLOSE.png", label: "å¡—ç¥è¼¸äº†...å—šå—šå—š ğŸ˜¢", border: "#2ecc71" }, 
        // push: å¹³æ‰‹ (å°æ‡‰ TUSHENDRAW.png)
        push: { src: "TUSHENDRAW.png", label: "å¹³æ‰‹ã€‚å†ä¾†ä¸€æŠŠï¼ŸğŸ˜", border: "#95a5a6" } 
    };

    // åˆå§‹åŒ–ç‰Œçµ„
    function createDeck() {
        deck = [];
        for (let suit of suits) {
            for (let value of values) {
                deck.push({ suit, value });
            }
        }
        for (let i = deck.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [deck[i], deck[j]] = [deck[j], deck[i]];
        }
    }

    // è¨ˆç®—å¡ç‰Œé»æ•¸
    function getCardValue(card) {
        if (['J', 'Q', 'K'].includes(card.value)) return 10;
        if (card.value === 'A') return 11;
        return parseInt(card.value);
    }

    // è¨ˆç®—æ‰‹ç‰Œç¸½åˆ†
    function calculateScore(hand) {
        let score = 0;
        let aceCount = 0;
        for (let card of hand) {
            score += getCardValue(card);
            if (card.value === 'A') aceCount++;
        }
        while (score > 21 && aceCount > 0) {
            score -= 10;
            aceCount--;
        }
        return score;
    }

    // æ¸²æŸ“å¡ç‰Œ
    function renderCard(card, container, hidden = false) {
        const cardDiv = document.createElement('div');
        cardDiv.className = `card ${['â™¥', 'â™¦'].includes(card.suit) ? 'red' : 'black'}`;
        
        if (hidden) {
            // ç‰ŒèƒŒè¨­è¨ˆ
            cardDiv.style.background = '#e67e22'; 
            cardDiv.style.backgroundImage = 'repeating-linear-gradient(45deg, transparent, transparent 10px, #d35400 10px, #d35400 20px)';
            cardDiv.style.border = '2px solid white';
        } else {
            cardDiv.innerHTML = `
                <div style="text-align:left">${card.value}</div>
                <div class="suit-center">${card.suit}</div>
                <div style="text-align:right">${card.value}</div>
            `;
        }
        container.appendChild(cardDiv);
    }

    // æ›´æ–°ä»‹é¢
    function updateUI(showDealerHidden = false) {
        const dContainer = document.getElementById('dealer-cards');
        const pContainer = document.getElementById('player-cards');
        dContainer.innerHTML = '';
        pContainer.innerHTML = '';

        dealerHand.forEach((card, index) => {
            if (index === 0 && !showDealerHidden) {
                renderCard(card, dContainer, true);
            } else {
                renderCard(card, dContainer);
            }
        });

        playerHand.forEach(card => renderCard(card, pContainer));

        document.getElementById('player-score').innerText = calculateScore(playerHand);
        document.getElementById('dealer-score').innerText = showDealerHidden ? calculateScore(dealerHand) : "?";
    }

    function showMessage(msg, color = '#f1c40f') {
        const el = document.getElementById('message-area');
        el.innerText = msg;
        el.style.color = color;
    }

    function toggleButtons(playing) {
        document.getElementById('btn-new').style.display = playing ? 'none' : 'inline-block';
        document.getElementById('btn-hit').style.display = playing ? 'inline-block' : 'none';
        document.getElementById('btn-stand').style.display = playing ? 'inline-block' : 'none';
    }

    // æ›´æ–°å¡—ç¥åœ–ç‰‡èˆ‡æ¨™ç±¤çš„å‡½æ•¸
    function updateTushenImage(state) {
        const img = document.getElementById('tushen-image');
        const label = document.getElementById('tushen-label');
        const data = tushenImages[state];
        
        img.src = data.src;
        img.style.borderColor = data.border;
        
        if (state !== 'normal') {
            label.innerText = data.label;
            label.style.opacity = 1;
            // æ ¹æ“šç‹€æ…‹æ”¹è®Šæ¨™ç±¤é¡è‰²
            if (state === 'lose') label.style.background = 'rgba(46, 204, 113, 0.9)'; // ç©å®¶è´(å¡—ç¥è¼¸)ï¼Œç¶ è‰²
            else if (state === 'win') label.style.background = 'rgba(231, 76, 60, 0.9)'; // ç©å®¶è¼¸(å¡—ç¥è´)ï¼Œç´…è‰²
            else label.style.background = 'rgba(149, 165, 166, 0.9)'; // å¹³æ‰‹ï¼Œç°è‰²
        } else {
            label.style.opacity = 0;
        }
    }

    // é–‹å§‹éŠæˆ²
    function startGame() {
        createDeck();
        playerHand = [deck.pop(), deck.pop()];
        dealerHand = [deck.pop(), deck.pop()];
        gameOver = false;
        
        updateUI(false);
        toggleButtons(true);
        showMessage("å¡—ç¥ï¼šæ”¾é¦¬éä¾†å§ï¼(è¦ç‰Œ/åœç‰Œ)");
        updateTushenImage('normal'); // é‡ç½®ç‚ºåŸå§‹åœ–ç‰‡

        if (calculateScore(playerHand) === 21) {
            stand();
        }
    }

    // è¦ç‰Œ
    function hit() {
        if (gameOver) return;
        playerHand.push(deck.pop());
        updateUI(false);

        if (calculateScore(playerHand) > 21) {
            // ç©å®¶çˆ†ç‰Œï¼Œå¡—ç¥è´
            endGame("çˆ†ç‰Œäº†ï¼å¡—ç¥ç²å‹ï¼", '#e74c3c', 'win');
        }
    }

    // åœç‰Œ
    function stand() {
        if (gameOver) return;
        while (calculateScore(dealerHand) < 17) {
            dealerHand.push(deck.pop());
        }
        updateUI(true);
        determineWinner();
    }

    // åˆ¤æ–·å‹è² 
    function determineWinner() {
        const pScore = calculateScore(playerHand);
        const dScore = calculateScore(dealerHand);

        if (dScore > 21) {
            // èŠå®¶çˆ†ç‰Œï¼Œå¡—ç¥è¼¸
            endGame("å¡—ç¥çˆ†ç‰Œäº†ï¼æ‚¨è´äº†ï¼ ğŸ‰", '#2ecc71', 'lose');
        } else if (pScore > dScore) {
            // ç©å®¶é»æ•¸å¤§ï¼Œå¡—ç¥è¼¸
            endGame("æ­å–œï¼æˆ°å‹äº†å¡—ç¥ï¼ ğŸ†", '#2ecc71', 'lose');
        } else if (pScore < dScore) {
            // èŠå®¶é»æ•¸å¤§ï¼Œå¡—ç¥è´
            endGame("å¡—ç¥æŠ€é«˜ä¸€ç±Œï¼Œæ‚¨è¼¸äº†ã€‚ ğŸ”§", '#e74c3c', 'win');
        } else {
            // å¹³æ‰‹
            endGame("å¹³å±€ (Push)ï¼å†ä¾†ä¸€æŠŠï¼", 'white', 'push');
        }
    }

    // çµæŸéŠæˆ²
    function endGame(msg, color, imageState) {
        gameOver = true;
        showMessage(msg, color);
        toggleButtons(false);
        document.getElementById('btn-new').innerText = "å†æŒ‘æˆ°ä¸€æ¬¡";
        updateTushenImage(imageState); // æ›´æ–°åœ–ç‰‡ç‹€æ…‹
    }
</script>

</body>
</html>